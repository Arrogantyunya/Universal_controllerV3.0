# 一、loRa设备通用协议V2.0.2

## **协议要点**

* LoRa设备传输数据总长度不得超过**200** Byte


* LoRa设备下属可以挂载子设备，例如：485设备，多路开关型设备；需要分别上报及绑定主设备及子设备的相关设置参数（地址、Sn等等）
* LoRa网关下发指令时可采用单播和广播的方式进行，Addr使用单播或者广播地址，发送前加设备信息**8**byte（**0x61的帧头+设备地址+控制字+数据包序**）
* 节点上传数据到网关时模块自动添加设备信息**8**byte（**0x41的帧头+地址+控制字+数据包序**），基地服务器解析是可获得地址，该地址与下位机采集传输的地址可用于校验
* 通用指令回复系统状态，工程调试可以看到详细状态，`confType`=`LORA_COMMON_CMD`

## 1 设备通用指令（基地服务器<->LoRa设备）

**设备安装逻辑流程**

**新设备按按键上报设置参数**（E011）------>等待扫码或输入sn绑定设备区域及设置参数------->基地服务器设置SN及总路数（A013）------->前端设置设备工作组---->基地服务器发送设置工作组编号(A012)---->发送控制指令正常工作



### 1.1 基地服务器查询LoRa设备当前工作参数（A011）

`兼容预留设置LoRa设备时间及间隔协议`

`可查询主设备及子设备参数，role==0x00查询（或设置）主设备参数，role==0x55查询（或设置）所有设备参数，role==子设备路数，查询（或设置）相应路数参数`

协议格式如下`表1-1-1`

#### 协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4\|5     |      6      |   7    |   8    |    9    |  10-11   |     12-18      |      19-26       |  27   |       28-32       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :----: | :-----: | :------: | :------------: | :--------------: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | intent | channel | Interval |    NewTime     |     Allocate     | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |      1      |   1    |   1    |    1    |    2     |       7        |        8         |   1   |         2         |
|   示例数据   |       61        | 00000071 |   00 XXXX    |    FE     |  A011   |   17    |     C001     |     55      |   01   |   55   |   00    |  00 3C   | 20180824141702 | 0000000000000000 |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明                     | 长度（byte） | 备注                                                                |
| --------------- | :----------------------- | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头                 |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址                 |      4       | 00000071(广播，所有设备上报自己的ID和SN)                            |
| deviceOthers    | 控制字等                 |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头                     |      2       | FE                                                                  |
| FrameId         | 帧ID                     |      2       | A011                                                                |
| DataLen         | 数据长度                 |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID               |      2       | 查看设备类型对照表（5555：所有类型）                                |
| IsBroadcast     | 是否广播指令             |      1       | 0x55是，00否                                                        |
| ZoneId          | 所属区域Id               |      1       | 0x55表示所有区域                                                    |
| intent          | 要求LoRa设备重新请求分号 |      1       | 0x00：不请求只设置参数，0x55：重新请求                              |
| channel         | 查询角色                 |      1       | 0x00：表示主控，0x55:表示所有设备参数，其他表示相应路数的子设备     |
| Interval        | LoRa设备的采集时间间隔   |      2       | 十六进制整数，单位为秒                                              |
| NewTime         | 新设置的RTC时间          |      7       | BCD码值，如`20180824141702`代表`2018年8月24日14点17分零2秒`         |
| Allocate        | 预留字段                 |      8       | 预留做他用                                                          |
| CRC8            | CRC8校验码               |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾                     |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

要求ID为`71000000`（所有设备），设备类型ID为C001的LoRa设备上报它及其下属子设备设置参数：

```shell
61 00000071 000100 FE A011 14 01 55 55 003C 20190307114315 0000000000000000 ED 0D0A0D0A0D0A
```

**回复--通用回执（01）**

```C
41 0C2A4314 00BE00 FE E015 0D C001 01 00 01 0000000000000000 16 0D0A0D0A0D0A
```

**上报当前参数**`查询所有时，有多少路上报多少路`

```c
410C2A4314009200     FE E011 22 C001 01 C00120190304150001 00 0000000000 003C  201903041502 0000000000000000 A7 0D0A0D0A0D0A
```

**基地服务器设置并发送系统消息：**

```javascript
__loRaAddDeviceParams(addr, freameData, (sta, msg, para) => {
    __redisPub_sysConfigAck('LORA_COMMON_CMD', 'ADD_DEVICE', sta, msg, para);
});
```



### 1.2 LoRa设备上报当前设置参数（E011）

#### 返回协议帧格式

|   字节索引   |     0     |  1\|2   |    3    |     4\|5     |      6      |   7    |     8-12     |       13-21        |   22    |  23-24   |     25-31      |      32-39       |  40   |       41-46       |
| :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :----------: | :----------------: | :-----: | :------: | :------------: | :--------------: | :---: | :---------------: |
|    数据域    | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | GroupIdArray |      DeviceSn      | channel | Interval |    NewTime     |     Allocate     | CRC8  |     FrameEnd      |
| 长度（byte） |     1     |    2    |    1    |      2       |      1      |   1    |      5       |         9          |    1    |    2     |       7        |        8         |   1   |         2         |
|   示例数据   |    FE     |  E011   |   24    |     C001     |     55      |   55   |   01020306   | XXXXXXXXXXXXXXXXXX |   00    |  00 3C   | 20180824141702 | 0000000000000000 |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域       | 说明                   | 长度（byte） | 备注                                                                |
| ------------ | :--------------------- | :----------: | :------------------------------------------------------------------ |
| FrameHead    | 帧头                   |      2       | FE                                                                  |
| FrameId      | 帧ID                   |      2       | E011                                                                |
| DataLen      | 数据长度               |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId | 设备类型ID             |      2       | 查看设备类型对照表                                                  |
| IsBroadcast  | 是否广播指令           |      1       | 0x55是，00否                                                        |
| ZoneId       | 所属区域Id             |      1       | 0x55表示所有区域                                                    |
| channel      | 子设备路数             |      1       | 0x00表示主设备（无子设备情况），其他表示相应路数                    |
| GroupIdArray | 组编号数组             |      5       | 最多5个组，组id(2byte)不为00时有效                                  |
| Interval     | LoRa设备的采集时间间隔 |      2       | 十六进制整数，单位为秒                                              |
| NewTime      | 新设置的RTC时间        |      7       | BCD码值，如`20180824141702`代表`2018年8月24日14点17分零2秒`         |
| Allocate     | 预留字段               |      8       | 预留做他用                                                          |
| CRC8         | CRC8校验码             |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd     | 帧尾                   |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

ID为`14052A0C`的LoRa设备重新上报设置参数：

```javascript
41 0C256514 000500 FE E011 24 C001 55 01 0100000000 C00120190304150001 00 0000 FFFFFFFFFFFFFF 0000000000000000 23 0D0A0D0A0D0A
```



### 1.3 LoRa设备请求设置工作组编号（E012）

#### 协议帧格式

|   字节索引   |     0     |  1\|2   |    3    |     4\|5     |      6      |   6    |    7    |   8   |       9-14        |
| :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----: | :---: | :---------------: |
|    数据域    | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | channel | CRC8  |     FrameEnd      |
| 长度（byte） |     1     |    2    |    1    |      2       |      1      |   1    |    1    |   1   |         2         |
|   示例数据   |    FE     |  E012   |   04    |     C001     |     55      |   01   |   00    |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域       | 说明         | 长度（byte） | 备注                                                                |
| ------------ | :----------- | :----------: | :------------------------------------------------------------------ |
| FrameHead    | 帧头         |      2       | FE                                                                  |
| FrameId      | 帧ID         |      2       | E012                                                                |
| DataLen      | 数据长度     |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId | 设备类型ID   |      2       | 查看设备类型对照表                                                  |
| IsBroadcast  | 是否广播指令 |      1       | 0x55是，00否                                                        |
| ZoneId       | 所属区域Id   |      1       | 0x55表示所有区域                                                    |
| channel      | 设备路数     |      1       | 0x00表示主设备，其他表示相应路数                                    |
| CRC8         | CRC8校验码   |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd     | 帧尾         |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

````javascript
41 0C2A4314 00BB00    FE E012 04 C001 01 00 E1 0D0A0D0A0D0A
````

### 1.4 基地服务器设置LoRa设备工作组编号(A012)

`channel==0x00表示设置主设备参数，channel==0x55表示设置所有子设备参数，等于其他表示设置其下属的某路子设备参数`

协议格式如下`表1-1-1`

#### 协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4\|5     |      6      |   7    |     8-12     |   13    |  14   |       15-20       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :----------: | :-----: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | GroupIdArray | channel | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |      1      |   1    |      5       |    1    |   1   |         2         |
|   示例数据   |       61        | 00000071 |   00 XXXX    |    FE     |  A012   |   10    |     C001     |     00      |   01   |  0000000000  |   00    |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明         | 长度（byte） | 备注                                                                         |
| --------------- | :----------- | :----------: | :--------------------------------------------------------------------------- |
| DeviceFrameHead | 硬件帧头     |      1       | 仁钰LoRa M-KL9按地址发送时需要                                               |
| Addr            | 设备地址     |      4       | 00000071(广播，所有设备上报自己的ID和SN)                                     |
| deviceOthers    | 控制字等     |      3       | 仁钰LoRa M-KL9按地址发送时需要                                               |
| FrameHead       | 帧头         |      2       | FE                                                                           |
| FrameId         | 帧ID         |      2       | A012                                                                         |
| DataLen         | 数据长度     |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位）          |
| DeviceTypeId    | 设备类型ID   |      2       | 查看设备类型对照表（5555：所有类型）                                         |
| IsBroadcast     | 是否广播指令 |      1       | 0x55是，00否                                                                 |
| ZoneId          | 所属区域Id   |      1       | 0x55表示所有区域                                                             |
| channel         | 设备路数     |      1       | 0x00设置主设备（无子设备情况），0x55设置所有子设备，其他设置相应路数的子设备 |
| GroupIdArray    | 组编号数组   |      5       | 最多5个组，组id(2byte)不为00时有效                                           |
| CRC8            | CRC8校验码   |      1       | 用于进行CRC8计算的数据DataLen指代的长度                                      |
| FrameEnd        | 帧尾         |      6       | 0d 0a 0d 0a 0d 0a                                                            |

**应用示例：**

设置ID为`0C3B6214`的设备组编号数组为0100000000

```shell
61 0C3B6214 000100 FE A012 0A C001 00 01 0100000000 00 57 0D0A0D0A0D0A
```

**基地服务器发送设置指令(添加到发送队列)**

```javascript
addCmdToSenderPool('REPLACE', loRaSenderPacket);
```

**发生错误回复系统状态**

```javascript
__redisPub_sysConfigAck('LORA_COMMON_CMD', "SET_GROUP_ID_ARRAY", 'failure', "设置LoRa设备工作组编号发生错误", errInfo);
```



### 1.5 LoRa设备请求设置SN设备类型及子设备路数(E013)

#### 协议帧格式

|   字节索引   |     0     |  1\|2   |    3    |     4\|5     |      6      |   7    |       8       |   9   |                   |
| :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----------: | :---: | :---------------: |
|    数据域    | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | DeviceChannel | CRC8  |     FrameEnd      |
| 长度（byte） |     1     |    2    |    1    |      2       |      1      |   1    |       1       |   1   |         2         |
|   示例数据   |    FE     |  E013   |   05    |     C001     |     55      |   01   |      01       |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域        | 说明         | 长度（byte） | 备注                                                                |
| ------------- | :----------- | :----------: | :------------------------------------------------------------------ |
| FrameHead     | 帧头         |      2       | FE                                                                  |
| FrameId       | 帧ID         |      2       | E013                                                                |
| DataLen       | 数据长度     |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId  | 设备类型ID   |      2       | 查看设备类型对照表                                                  |
| IsBroadcast   | 是否广播指令 |      1       | 0x55是，00否                                                        |
| ZoneId        | 所属区域Id   |      1       | 0x55表示所有区域                                                    |
| DeviceChannel | 设备路数     |      1       | 主设备：0x00                                                        |
| CRC8          | CRC8校验码   |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd      | 帧尾         |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

```javascript
41 0C2A4314 004A00 FE E013 04 C001 01 00 E1 0D0A0D0A0D0A
610C3B6214000100FEA0120AC0010001010000000000570D0A0D0A0D0A
```



### 1.6 基地服务器设置设备（主/子）SN及子设备总路数(A013)

#### 协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4\|5     |      6      |   7    |       8       |      9      |       10-18        |  19   |       20-25       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----------: | :---------: | :----------------: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | DeviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | DeviceChannel | SlaverCount |      DeviceSn      | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |      1      |   1    |       1       |      1      |         9          |   1   |         2         |
|   示例数据   |       61        | 14052A0C |   00 XXXX    |    FE     |  E013   |   0F    |     C001     |     55      |   01   |      00       |     00      | 000000000000000000 |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明             | 长度（byte） | 备注                                                                |
| --------------- | :--------------- | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头         |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址         |      4       | 00000071(广播，所有设备上报自己的ID和SN)                            |
| DeviceOthers    | 控制字等         |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头             |      1       | FE                                                                  |
| FrameId         | 帧ID             |      2       | A013                                                                |
| DataLen         | 数据长度         |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID       |      2       | 查看设备类型对照表                                                  |
| IsBroadcast     | 是否广播指令     |      1       | 0x55是，00否                                                        |
| ZoneId          | 所属区域Id       |      1       | 0x55表示所有区域                                                    |
| DeviceChannel   | 设备路数         |      1       | 主设备：0x00                                                        |
| SlaverCount     | 子设备总路数     |      1       | 子设备总数                                                          |
| DeviceSn        | 设置的LoRa设备SN |      9       |                                                                     |
| CRC8            | CRC8校验码       |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾             |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

```javascript
61 14432A0C 000100 FE A013 0E C001 01 00 02 C00120190304150001 15 0D0A0D0A0D0A
```

### 1.7 查询LoRa设备当前工作状态（A014）

#### 协议帧格式，具体设备查看4

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4\|5     |      6      |   7    |    8    |    9    |  10   |       11-16       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----: | :-----: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | GroupId | channel | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |      1      |   1    |    1    |    1    |   1   |         2         |
|   示例数据   |       61        | 00000071 |   00 XXXX    |    FE     |  A014   |   06    |     5555     |     55      |   01   |   01    |   00    |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明       | 长度（byte） | 备注                                                                |
| --------------- | :--------- | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头   |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址   |      4       | 00000071(广播，所有设备上报自己的ID和SN)                            |
| deviceOthers    | 控制字等   |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头       |      2       | FE                                                                  |
| FrameId         | 帧ID       |      2       | A011                                                                |
| DataLen         | 数据长度   |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID |      2       | 查看设备类型对照表（5555：所有类型）                                |
| ZoneId          | 所属区域Id |      1       | 0x55表示所有区域                                                    |
| GroupId         | 组id       |      1       |                                                                     |
| channel         | 查询角色   |      1       | 0x00：表示主控，0x55表示所有，其他表示相应路数的子设备              |
| CRC8            | CRC8校验码 |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾       |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

```javascript
61 14432A0C 000100 FE A014 04 C001 01 01 00 E1 0D0A0D0A0D0A
```

### 1.8 LoRa设备上报实时工作状态（E014）

#### 返回协议帧格式

|   字节索引   |     0     |  1\|2   |    3    |     4\|5     |      6      |   7    |    8    |   9    | 10-11 |  12   |  13   |              14-29               |  30   |       31-36       |
| :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----: | :----: | :---: | :---: | :---: | :------------------------------: | :---: | :---------------: |
|    数据域    | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | channel | status |  Vol  | Rssi  |  Csq  |             Allocate             | CRC8  |     FrameEnd      |
| 长度（byte） |     1     |    2    |    1    |      2       |      1      |   1    |    1    |   1    |   2   |   1   |   1   |                16                |   1   |         2         |
|   示例数据   |    FE     |  E014   |   12    |     C001     |     55      |   01   |   00    |   00   | 2EE0  |  FF   |  FF   | 00000000000000000000000000000000 |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域       | 说明             | 长度（byte） | 备注                                                                |
| ------------ | :--------------- | :----------: | :------------------------------------------------------------------ |
| FrameHead    | 帧头             |      2       | FE                                                                  |
| FrameId      | 帧ID             |      2       | E014                                                                |
| DataLen      | 数据长度         |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId | 设备类型ID       |      2       | 查看设备类型对照表（5555：所有类型）                                |
| IsBroadcast  | 是否广播指令     |      1       | 0x55是，00否                                                        |
| ZoneId       | 所属区域Id       |      1       | 0x55表示所有区域                                                    |
| Addr         | 设备地址         |      4       | 设备地址（全部为55555555）                                          |
| status       | 设备当前工作状态 |      1       | 对应回执状态表                                                      |
| Vol          | 电压             |      2       |                                                                     |
| Rssi         | 性噪比           |      1       |                                                                     |
| Csq          | 信号强度         |      1       |                                                                     |
| Allocate     | 预留字段         |      16      | 预留做他用                                                          |
| CRC8         | CRC8校验码       |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd     | 帧尾             |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

ID为`14052A0C`的LoRa设备上报实时工作状态：

```
41 0C2A4314 00BF00 FE E014 29 C001 01 00 01 2EE0 FFFF 00000000000000000000000000000000 69 0D0A0D0A0D0A
```



### 1.9 强制停止工作指令（A015）

#### 协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4\|5     |      6      |   7    |    8    |    9    |  10   |       11-16       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----: | :-----: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | GroupId | channel | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |      1      |   1    |    1    |    1    |   1   |         2         |
|   示例数据   |       61        | 00000071 |   00 XXXX    |    FE     |  A015   |   06    |     5555     |     55      |   01   |   01    |   00    |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明         | 长度（byte） | 备注                                                                |
| --------------- | :----------- | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头     |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址     |      4       | 00000071(广播，所有设备上报自己的ID和SN)                            |
| deviceOthers    | 控制字等     |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头         |      2       | FE                                                                  |
| FrameId         | 帧ID         |      2       | A015                                                                |
| DataLen         | 数据长度     |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID   |      2       | 查看设备类型对照表（5555：所有类型）                                |
| IsBroadcast     | 是否广播指令 |      1       | 0x55是，00否                                                        |
| ZoneId          | 所属区域Id   |      1       | 0x55表示所有区域                                                    |
| GroupId         | 组Id         |      1       | 0x55表示所有组                                                      |
| Addr            | 设备地址     |      4       | 设备地址（全部为55555555）                                          |
| channel         | 查询角色     |      1       | 0x00：表示主控，0x55表示所有，其他表示相应路数的子设备              |
| CRC8            | CRC8校验码   |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾         |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

要求ID为`14052A0C`，的LoRa主设备重新上报设置参数：

```javascript
61 14432A0C 000100 FE A015 04 C001 01 00 E1 0D0A0D0A0D0A
```



### 1.10 LoRa设备通用回执(E015)

#### 返回协议帧格式

|   字节索引   |     0     |  1\|2   |    3    |     4\|5     |      6      |   7    |    8    |   9    |      10-17       |  18   |       19-24       |
| :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----: | :----: | :--------------: | :---: | :---------------: |
|    数据域    | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | ZoneId | channel | status |     Allocate     | CRC8  |     FrameEnd      |
| 长度（byte） |     1     |    2    |    1    |      2       |      1      |   1    |    1    |   1    |        8         |   1   |         2         |
|   示例数据   |    FE     |  E015   |   0E    |     C001     |     55      |   01   |   00    |   00   | 0000000000000000 |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域       | 说明             | 长度（byte） | 备注                                                                |
| ------------ | :--------------- | :----------: | :------------------------------------------------------------------ |
| FrameHead    | 帧头             |      2       | FE                                                                  |
| FrameId      | 帧ID             |      2       | E012                                                                |
| DataLen      | 数据长度         |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId | 设备类型ID       |      2       | 查看设备类型对照表（5555：所有类型）                                |
| IsBroadcast  | 是否广播指令     |      1       | 0x55是，00否                                                        |
| ZoneId       | 所属区域Id       |      1       | 0x55表示所有区域                                                    |
| Addr         | 设备地址         |      4       | 设备地址（全部为55555555）                                          |
| status       | 设备当前工作状态 |      1       | 对应回执状态表                                                      |
| Allocate     | 预留字段         |      8       | 预留做他用                                                          |
| CRC8         | CRC8校验码       |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd     | 帧尾             |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

ID为`14052A0C`的LoRa设备通用回执（收到查询参数指令）：

```
410C2A4314006100  FE E015 0D C001 01 00 01 0000000000000000 16 0D0A0D0A0D0A
```

# 二、 回执状态表 

## 1 LoRa卷膜机主控通用回执状态表 

| 状态名   | FactoryMode |  AskUploadParamsOk   |  AskUploadParamsErr  | AssignGroupIdArrayOk | AssignGroupIdArrayErr | SetSnAndSlaverCountOk  | SetSnAndSlaverCountErr | TrunOffOk        | TrunOffErr       |   RestRollerOk   |  ResetRollerErr  |    OpenRollerOk    |   OpenRollerErr    |   LimitRollerOk    |   LimitRollerErr   |
| -------- | :---------: | :------------------: | :------------------: | :------------------: | :-------------------: | :--------------------: | :--------------------: | ---------------- | ---------------- | :--------------: | :--------------: | :----------------: | :----------------: | :----------------: | :----------------: |
| 状态值   |     00      |          01          |          02          |          03          |          04           |           05           |           06           | 07               | 08               |        09        |        0A        |         0B         |         0C         |         0D         |         0E         |
| 状态说明 |  出厂模式   | 查询LoRa设备参数成功 | 查询LoRa设备参数失败 |   设置组Id数组成功   |   设置组Id数组失败    | 设置SN及子设备路数成功 | 设置SN及子设备路数失败 | 强制停止设备成功 | 强制停止设备失败 | 重置设备行程成功 | 重置设备行程失败 | 设置子设备开度成功 | 设置子设备开度失败 | 设置子设备阈值成功 | 设置子设备阈值失败 |

## 2 LoRa 11因素传感器通用回执状态表 

| 状态名   | FactoryMode |  AskUploadParamsOk   |  AskUploadParamsErr  | AssignGroupIdArrayOk | AssignGroupIdArrayErr | SetSnAndSlaverCountOk  | SetSnAndSlaverCountErr | SetParamsOk  | SetParamsErr |
| -------- | :---------: | :------------------: | :------------------: | :------------------: | :-------------------: | :--------------------: | :--------------------: | :----------: | :----------: |
| 状态值   |     00      |          01          |          02          |          03          |          04           |           05           |           06           |      07      |      08      |
| 状态说明 |  出厂模式   | 查询LoRa设备参数成功 | 查询LoRa设备参数失败 |   设置组Id数组成功   |   设置组Id数组失败    | 设置SN及子设备路数成功 | 设置SN及子设备路数失败 | 设置参数成功 | 设置参数失败 |

## 3 LoRa开关通用回执状态表 

| 状态名   | FactoryMode |  AskUploadParamsOk   |  AskUploadParamsErr  | AssignGroupIdArrayOk | AssignGroupIdArrayErr | SetSnAndSlaverCountOk  | SetSnAndSlaverCountErr |    TrunOffOk     |    TrunOffErr    | SetParamsOk  | SetParamsErr |
| -------- | :---------: | :------------------: | :------------------: | :------------------: | :-------------------: | :--------------------: | :--------------------: | :--------------: | :--------------: | :----------: | :----------: |
| 状态值   |     00      |          01          |          02          |          03          |          04           |           05           |           06           |        07        |        08        |      09      |      0A      |
| 状态说明 |  出厂模式   | 查询LoRa设备参数成功 | 查询LoRa设备参数失败 |   设置组Id数组成功   |   设置组Id数组失败    | 设置SN及子设备路数成功 | 设置SN及子设备路数失败 | 强制停止设备成功 | 强制停止设备失败 | 设置参数成功 | 设置参数失败 |

# 三、实时状态回复详细说明

## 1卷膜机实时状态回复

### 1.1 预留字段实际使用说明

|   字节索引   |     14      |    15-16    |        17-18         |      19-20       |         21         |      22-29       |
| :----------: | :---------: | :---------: | :------------------: | :--------------: | :----------------: | :--------------: |
|    数据域    | CurrentOpen | LowVolLimit | MaxMotorCurrentLimit | RealTime Current | StatusSendInterval |     Allocate     |
| 长度（byte） |      1      |      2      |          2           |        2         |         1          |        8         |
|   示例数据   |     00      |    2EE0     |         000A         |       003C       |         01         | 0000000000000000 |

CurrentOpen:当前开度

LowVolLimit:低电压阈值

MaxMotorCurrentLimit:最大工作电流百分比

RealTime Current:实时工作电流

StatusSendInterval:上报数据间隔

### 1.2 状态表

|  状态名  | FactoryMode | ROLL_OK  | HIGH_POSITION_LIMIT_EXCEPTION | LOW_POSITION_LIMIT_EXCEPTION | LOW_POWER  | MOTOR_EXCEPTION | MOTOR_CURRENT_EXCEPTION | ROLLING  | CMD_EXCEPTION | NOT_intentIALIZED | STORE_EXCEPTION | ResetRolling | ResetRollOK  | 485_EXCEPTION | FORCE_STOP |
| :------: | :---------: | :------: | :---------------------------: | :--------------------------: | :--------: | :-------------: | :---------------------: | :------: | :-----------: | :---------------: | :-------------: | :----------: | :----------: | :-----------: | :--------: |
|  状态值  |     00      |    01    |              02               |              03              |     04     |       05        |           06            |    07    |      08       |        09         |       0A        |      0B      |      0C      |      0D       |     0E     |
| 状态说明 |  出厂模式   | 卷膜完成 |        上限位限位异常         |          下限位异常          | 低电压异常 |    电机异常     |      卷膜电流异常       | 正在卷膜 |   指令异常    |     未初始化      |  数据储存异常   | 正在重置行程 | 重置行程完成 |  485模块异常  |  强制停止  |

**应用举例：**

```

```

## 2 开关型设备实时状态回复

### 2.1 预留字段实际使用说明

|   字节索引   |      14-15       |    16-18     |     19-21      |      22-29       |
| :----------: | :--------------: | :----------: | :------------: | :--------------: |
|    数据域    | CurrentOpenRatio | TotalWorkSec | CurrentWorkSec |     Allocate     |
| 长度（byte） |        2         |      3       |       3        |        8         |
|   示例数据   |       0000       |    0000FF    |     000000     | 0000000000000000 |

**CurrentOpenRatio**:设置开度

**TotalWorkSec**:设置工作时长

**CurrentWorkSec**:当前已工作时长

**Allocate**:根据不同开关型设备分别定义

### 2.2 状态表

|  状态名  | FactoryMode |   RUN_OK   | CLOSE_OK | OPEN_EXCEPTION | CLOSE_EXCEPTION | LOW_POWER  | SENSOR_EXCEPTION |
| :------: | :---------: | :--------: | :------: | :------------: | :-------------: | :--------: | :--------------: |
|  状态值  |     00      |     01     |    02    |       02       |       03        |     04     |        05        |
| 状态说明 |  出厂模式   | 设备运行中 | 设备关闭 |  打开设备异常  |  关闭设备异常   | 低电压异常 |    传感器异常    |

**应用举例：**

```

```

### 



# 四、LoRa执行器设备私有协议

## 1、LoRa卷膜机通信协议

### 1.1 重置LoRa卷膜机下属某路设备行程(A020)

基地服务器发送重置行程指令，设备开始重置行程，并回复正在重置行程及通用回执

#### 协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4-5      |      6      |   7    |    8    |       9       |  10   |       11-16       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----: | :-----------: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | zoneId | groupId | DeviceChannel | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |      1      |   1    |    1    |       1       |   1   |         2         |
|   示例数据   |       61        | 14052A0C |   00 XXXX    |    FE     |  A020   |   06    |     C001     |     55      |   01   |   01    |      00       |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明         | 长度（byte） | 备注                                                                |
| --------------- | :----------- | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头     |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址     |      4       |                                                                     |
| deviceOthers    | 控制字等     |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头         |      2       | FE                                                                  |
| FrameId         | 帧ID         |      2       | A001                                                                |
| DataLen         | 数据长度     |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID   |      2       | 查看设备类型对照表                                                  |
| IsBroadcast     | 是否广播指令 |      1       | 0x55是，00否                                                        |
| zoneId          | 区域Id       |      1       |                                                                     |
| groupId         | 组id         |      1       |                                                                     |
| DeviceChannel   | 设备路数     |      1       | 00：主设备                                                          |
| CRC8            | CRC8校验码   |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾         |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

重置ID为`14052A0C`的LoRa主设备行程

```c
61 00000071 000100 FE A020 05 C001 01 55 55 9A 0D0A0D0A0D0A
```

### 1.2 设置LoRa主控下属子设备开度(A021)

协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4-5      |      6      |   7    |    8    |       9       |  10   |  11   |       11-16       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----: | :-----------: | :---: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | zoneId | groupId | DeviceChannel | open  | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |      1      |   1    |    1    |       1       |   1   |   1   |         2         |
|   示例数据   |       61        | 14052A0C |   00 XXXX    |    FE     |  A021   |   06    |     C001     |     55      |   01   |   55    |      00       |  00   |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明       | 长度（byte） | 备注                                                                |
| --------------- | :--------- | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头   |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址   |      4       |                                                                     |
| deviceOthers    | 控制字等   |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头       |      2       | FE                                                                  |
| FrameId         | 帧ID       |      2       | A001                                                                |
| DataLen         | 数据长度   |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID |      2       | 查看设备类型对照表                                                  |
| zoneId          | 区域Id     |      1       |                                                                     |
| groupId         | 组id       |      1       |                                                                     |
| DeviceChannel   | 设备路数   |      1       | 00：主设备,0x55:所有路设备                                          |
| open            | 开度       |      1       |                                                                     |
| CRC8            | CRC8校验码 |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾       |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

设置区域01下所有设备开度为50

```json
61 00000071 000100 FE A021 06 C001 01 55 55 32 D6 0D0A0D0A0D0A
```

设置区域01下的01组设备开度为50

```c
61 00000071 000100 FE A021 06 C001 01 01 55 32 F5 0D0A0D0A0D0A
```



### 1.3 设置LoRa主控下属子设备工作阈值(A022)

基地服务器发送设置开度指令，设备开始工作，并回复通用回执，上报实时状态

群控时Addr为00000000，需要判断groupId是否存在，存在则回复通用回执并执行，不存在时什么都不做

单控时匹配Addr是否为本机地址，是则则回复通用回执并执行，不是时什么都不做

协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4-5      |      6      |   7    |    8    |       9       |     10-11      |        11-12         |         13         |  11   |       11-16       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----: | :-----------: | :------------: | :------------------: | :----------------: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | zoneId | groupId | DeviceChannel | LowBatVolLimit | MaxMotorCurrentLimit | StatusSendInterval | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |      1      |   1    |    1    |       1       |       2        |          2           |         1          |   1   |         2         |
|   示例数据   |       61        | 14052A0C |   00 XXXX    |    FE     |  A022   |   0B    |     C001     |     55      |   01   |   55    |      00       |      2EE0      |         02BC         |         01         |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域               | 说明                     | 长度（byte） | 备注                                                                |
| -------------------- | :----------------------- | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead      | 硬件帧头                 |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr                 | 设备地址                 |      4       |                                                                     |
| deviceOthers         | 控制字等                 |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead            | 帧头                     |      2       | FE                                                                  |
| FrameId              | 帧ID                     |      2       | A001                                                                |
| DataLen              | 数据长度                 |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId         | 设备类型ID               |      2       | 查看设备类型对照表                                                  |
| IsBroadcast          | 是否广播指令             |      1       | 0x55是，00否                                                        |
| zoneId               | 区域Id                   |      1       |                                                                     |
| groupId              | 组id                     |      1       |                                                                     |
| DeviceSn             | LoRa设备SN               |      9       |                                                                     |
| DeviceChannel        | 设备路数                 |      1       | 00：主设备，55所有路子设备                                          |
| LowBatVolLimit       | 最小工作电压             |      2       |                                                                     |
| MaxMotorCurrentLimit | 最大卷膜工作电流对应电压 |      2       |                                                                     |
| StatusSendInterval   | 状态上报时间间隔         |      2       | 0000按开度10%报                                                     |
| CRC8                 | CRC8校验码               |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd             | 帧尾                     |      6       | 0d 0a 0d 0a 0d 0a                                                   |

应用示例：

设置ID为`14052A0C`的LoRa主设备下属的所有子设备电池最小工作电压12000 (2EE0)mV,控制电压阈值02BC (700)mV

```c
6100000071000100 FE A022 0B C001 55 01 55 55 04B0 02BC 01 F4 0D0A0D0A0D0A
```



## 2、LoRa开关型设备调用接口

**使用说明:**通用指令都需要

**设备使用流程:**

* 上报开关型设备参数及子设备路数**E011**(设备初始安装,按键上报)---->>服务器按照子设备路数分别添加多条记录

* 前端设置控制器的SN(扫码绑定每一路的外围开关子设备,绑定相关设备信息)**A013**---->通用回执(**E015**)
* 前端分别编辑N路设备的设备信息(设备名称等)
* 分别添加N路设备到各自的执行器工作组,修改各路工作组ID数组**A014**---->通用回执(**E015**)
* 组控或单控某类型开关设备**A025**---->通用回执(**E015**)
* 设备分路数上报自己的实时状态**E014**

### 2.1 设置LoRa开关设备开关参数及执行时间(A025)

2.1 协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4-5      |      6      |   7    |    8    |       9       |   10-11   |  11-13  |      14-21       |  22   |       23-28       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :---------: | :----: | :-----: | :-----------: | :-------: | :-----: | :--------------: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | IsBroadcast | zoneId | groupId | DeviceChannel | OpenRatio | WorkSec |     Allocate     | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |      1      |   1    |    1    |       1       |     2     |    3    |        8         |   1   |         6         |
|   示例数据   |       61        | 14052A0C |   00 XXXX    |    FE     |  A025   |   13    |     C001     |     55      |   01   |   55    |      00       |   0000    | 000000  | 0000000000000000 |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明         | 长度（byte） | 备注                                                                |
| --------------- | :----------- | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头     |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址     |      4       |                                                                     |
| deviceOthers    | 控制字等     |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头         |      2       | FE                                                                  |
| FrameId         | 帧ID         |      2       | A001                                                                |
| DataLen         | 数据长度     |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID   |      2       | 查看设备类型对照表                                                  |
| IsBroadcast     | 是否广播指令 |      1       | 0x55是，00否                                                        |
| zoneId          | 区域Id       |      1       |                                                                     |
| groupId         | 组id         |      1       |                                                                     |
| DeviceChannel   | 设备路数     |      1       | 00：主设备,0x55:所有路设备                                          |
| OpenRatio       | 开度         |      2       | 0x0064全开，0x0000全关                                              |
| WorkSec         | 超时关闭时间 |      3       | 0x000000表示一直保持当前状态,单位秒,                                |
| Allocate        | 预留字段     |      8       |                                                                     |
| CRC8            | CRC8校验码   |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾         |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

设置区域01下所有开关设备设备开度为50，一直保持打开状态

```json
61 00000071 000100 FE A025 12 C001 55 01 55 55 32 00000000 0000000000000000 D6 0D0A0D0A0D0A
```

设置区域01下的01组设备开度为50，设置打开时长10s

```c
61 00000071 000100 FE A025 12 C001 55 01 01 55 32 00000A 0000000000000000 F5 0D0A0D0A0D0A
```



# 五、LoRa传感器设备私有协议

## 1.设置LoRa传感器的RTC时间和采集时间间隔(A011)

**ZoneId=0x55,intent=0x00,channel=0x00设置参数**,地址为广播地址，设置某类型所有设备

#### 协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4\|5     |   6    |   7    |    8    |   9-10   |     11-17      |      18-25       |  26   |       27-31       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :----: | :----: | :-----: | :------: | :------------: | :--------------: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | ZoneId | intent | channel | Interval |    NewTime     |     Allocate     | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |   1    |   1    |    1    |    2     |       7        |        8         |   1   |         2         |
|   示例数据   |       61        | 00000071 |   00 XXXX    |    FE     |  A011   |   1A    |     C001     |   01   |   00   |   00    |  00 3C   | 20180824141702 | 0000000000000000 |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明                     | 长度（byte） | 备注                                                         |
| --------------- | :----------------------- | :----------: | :----------------------------------------------------------- |
| DeviceFrameHead | 硬件帧头                 |      1       | LoRa 按地址发送时需要                                        |
| Addr            | 设备地址                 |      4       | 00000071(广播，所有设备上报自己的ID和SN)                     |
| deviceOthers    | 控制字等                 |      3       | LoRa 按地址发送时需要                                        |
| FrameHead       | 帧头                     |      2       | FE                                                           |
| FrameId         | 帧ID                     |      2       | A011                                                         |
| DataLen         | 数据长度                 |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID               |      2       | 查看设备类型对照表（5555：所有类型）                         |
| ZoneId          | 所属区域Id               |      1       | 0x55表示所有区域                                             |
| intent          | 要求LoRa设备重新请求分号 |      1       | 0x00：不请求只设置参数，0x55：重新请求                       |
| channel         | 查询角色                 |      1       | 0x00：表示主控，0x55:表示所有设备参数，其他表示相应路数的子设备 |
| Interval        | LoRa设备的采集时间间隔   |      2       | 十六进制整数，单位为秒                                       |
| NewTime         | 新设置的RTC时间          |      7       | BCD码值，如`20180824141702`代表`2018年8月24日14点17分零2秒`  |
| Allocate        | 预留字段                 |      8       | 预留做他用                                                   |
| CRC8            | CRC8校验码               |      1       | 用于进行CRC8计算的数据DataLen指代的长度                      |
| FrameEnd        | 帧尾                     |      6       | 0d 0a 0d 0a 0d 0a                                            |

**应用示例：**

设置类型为11因素传感器的所有传感器采集间隔为`60`秒，新设置的RTC时间为`2018年8月24日15时20分12秒`，其指令如下：

```shell
61 00000071 000100 FE A011 1A 0001 01 00 00 003C 20190307114315 0000000000000000 ED 0D0A0D0A0D0A
```



## 2 LoRa无线传感器上报数据格式

### 2.1LoRa无线11因素百叶箱数据协议 (SensorType:0001)

#### 协议帧格式如下`表2-1-1-1`

**表2-1-1-1 LoRa无线11因素百叶箱上传数据至网关协议帧格式**

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |    4~5     |  6~7   |    8~10     |  11~13   |     14~18     |    19~23    |    24~26    | 27~29  | 30~32  |       33~35       |     35~38      |  39~41   |   42~44    |     45~51      |  52  |      53~58      |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :--------: | :----: | :---------: | :------: | :-----------: | :---------: | :---------: | :----: | :----: | :---------------: | :------------: | :------: | :--------: | :------------: | :--: | :-------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | SensorType | BatVol | Temperature | Humidity | LumiIntensity | AirPressure | UvIntensity |  CO2   | TVOCs  | Solid Temperature | Solid Humidity | Solid EC | Solid Salt |      Time      | CRC8 |    FrameEnd     |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |     2      |   2    |      3      |    3     |       5       |      5      |      3      |   3    |   3    |         3         |       3        |    3     |     3      |       7        |  1   |        6        |
|   示例数据   |       41        | 00000001 |   00 XXXX    |    FE     |  D001   |   30    |    0001    |  1051  |   2770E2    |  4679E2  |  00004142E0   |  008032E1   |   0011E2    | 0485E0 | 0012E0 |      2770E2       |     4679E2     |  0010E0  |   0010E0   | 20180824121755 |  00  | 0D 0A0D 0A0D 0A |

协议帧各字段域说明：

| 字段域          | 说明         | 长度（byte） | 备注                                                         |
| --------------- | :----------- | :----------: | :----------------------------------------------------------- |
| DeviceFrameHead | 硬件接收帧头 |      1       | 传感器LoRa帧头                                               |
| Addr            | 设备地址     |      4       | 传感器LoRa地址                                               |
| deviceOthers    | 控制字等     |      3       | 传感器LoRa控制字等                                           |
| FrameHead       | 帧头         |      1       | 数据帧头                                                     |
| FrameId         | 帧ID         |      2       | 数据帧ID                                                     |
| DataLen         | 数据长度     |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| SensorType      | 传感器类型码 |      2       | 此类型传感器的设备类型码为`00 01`                            |
| BatVol          | 传感器电压   |      2       | 单位为`mV`，十六进制表示整数                                 |
| Temperature     | 温度数据     |      3       | 单位为`摄氏度`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| Humidity        | 相对湿度     |      3       | 单位为`%`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| LumiIntensity   | 光照强度     |      5       | 单位为`Lux`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| AirPressure     | 大气压力     |      5       | 单位为`kPa`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| UvIntensity     | 紫外线强度   |      3       | 单位为`w/m2`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| CO2             | 二氧化碳浓度 |      3       | 单位为`ppm`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| TVOCs           | TVOCs浓度    |      3       | 单位为`ppm`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| Solid Temp      | 土壤温度     |      3       | 单位为`摄氏度`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| Solid Humi      | 土壤湿度     |      3       | 单位为`%`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| Solid EC        | 土壤导电率   |      3       | 单位为`us/cm`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| Solid Salt      | 土壤盐分     |      3       | 单位为`mg/L`，BCD码值，低位为符号位，符号位为`Ex`时为正，`Fx`时为负，其中`x`为小数位数 |
| Time            | 数据时间     |      7       | 时间的BCD码值                                                |
| CRC8            | CRC8校验码   |      1       | 用于进行CRC8计算的数据DataLen指代的长度                      |
| FrameEnd        | 帧尾         |      2       |                                                              |

**应用示例：**

传感器传了一笔电量值为`4177`mV，温度值为`27.70`，相对湿度为`46.79`，光照强度为`4142`, 大气压力`803.2`，紫外线强度为`1.1`， CO2浓度为`485`，TVOCs浓度为`12`,........，时间为`2018年08月24日12时17分55秒`的数据，其数据帧如下：

```shell
FE D001 30 0001 1051 2770E2 4679E2 00004142E0 008032E1 0011E2 0485E0 0012E0 2770E2 4679E2 0010E0 0010E0 20180824121755 00 0D0A0D0A0D0A
```

# 六、Bootloader相关接口

## 1、基地服务器发送升级指令（A001）

基地服务器发送升级指令，要求程序进入bootload，准备接收APP程序数据

#### 协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |   4-7    |  16   |       17-22       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :------: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen |   Addr   | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |    4     |   1   |         2         |
|   示例数据   |       61        | 14052A0C |   00 XXXX    |    FE     |  A001   |   0D    | 14052A0C |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明       | 长度（byte） | 备注                                                                |
| --------------- | :--------- | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头   |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址   |      4       |                                                                     |
| deviceOthers    | 控制字等   |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头       |      2       | FE                                                                  |
| FrameId         | 帧ID       |      2       | A001                                                                |
| DataLen         | 数据长度   |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID |      2       | 查看设备类型对照表                                                  |
| ZoneId          | 所属区域Id |      1       | 0xFF表示所有区域                                                    |
| Addr            | 设备地址   |      4       | 设备地址                                                            |
| CRC8            | CRC8校验码 |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾       |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

要求ID为`14052A0C`的LoRa主设备进入升级模式

## 2、下位机空闲发送应答码（E001）

下位机空闲则进入bootloader,发送应答码

#### 返回协议帧格式

|   字节索引   |     0     |  1\|2   |    3    |     4\|5     |   6    |   15   |  16   |       17-22       |
| :----------: | :-------: | :-----: | :-----: | :----------: | :----: | :----: | :---: | :---------------: |
|    数据域    | FrameHead | FrameId | DataLen | DeviceTypeId | ZoneId | status | CRC8  |     FrameEnd      |
| 长度（byte） |     1     |    2    |    1    |      2       |   1    |   1    |   1   |         2         |
|   示例数据   |    FE     |  E001   |   0C    |     C001     |   01   |   55   |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域       | 说明             | 长度（byte） | 备注                                                                |
| ------------ | :--------------- | :----------: | :------------------------------------------------------------------ |
| FrameHead    | 帧头             |      2       | FE                                                                  |
| FrameId      | 帧ID             |      2       | E001                                                                |
| DataLen      | 数据长度         |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId | 设备类型ID       |      2       | 查看设备类型对照表                                                  |
| ZoneId       | 所属区域Id       |      1       | 0xFF表示所有区域                                                    |
| status       | 设备当前工作状态 |      1       | 0x55：可升级，其他不可升级                                          |
| CRC8         | CRC8校验码       |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd     | 帧尾             |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

## 3、基地服务器发送前导码(A002)

基地服务器发送前导码，前导码包含信息：是APP软件包还是Bootloader包  软件版本号（可以断定续传），数据包数量，软件版本向量（指定工作在哪个版本APP程序）

#### 协议帧格式

|   字节索引   |       N/A       |   N/A    |     N/A      |     0     |  1\|2   |    3    |     4\|5     |   6    |    19    | 20-21  |    22-23     |     24-25      |  26   |       27-32       |
| :----------: | :-------------: | :------: | :----------: | :-------: | :-----: | :-----: | :----------: | :----: | :------: | :----: | :----------: | :------------: | :---: | :---------------: |
|    数据域    | DeviceFrameHead |   Addr   | deviceOthers | FrameHead | FrameId | DataLen | DeviceTypeId | ZoneId | softType | appVer | appPackCount |     runVer     | CRC8  |     FrameEnd      |
| 长度（byte） |        1        |    4     |      3       |     1     |    2    |    1    |      2       |   1    |    1     |   2    |      2       |       2        |   1   |         2         |
|   示例数据   |       61        | 0C2A0514 |   00 XXXX    |    FE     |  A011   |   17    |     5555     |   01   |    55    |  0001  |    00 3C     | 20180824141702 |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明          | 长度（byte） | 备注                                                                |
| --------------- | :------------ | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头      |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址      |      4       | 00000071(广播，所有设备上报自己的ID和SN)                            |
| deviceOthers    | 控制字等      |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头          |      2       | FE                                                                  |
| FrameId         | 帧ID          |      2       | A002                                                                |
| DataLen         | 数据长度      |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID    |      2       | 查看设备类型对照表                                                  |
| ZoneId          | 所属区域Id    |      1       | 0xFF表示所有区域                                                    |
| softType        | 软件包类型    |      1       | 0x55：APP运行程序，0x00:bootloader                                  |
| appVer          | app软件版本号 |      2       |                                                                     |
| appPackCount    | app包数量     |      2       |                                                                     |
| runVer          | 运行的版本号  |      2       |                                                                     |
| CRC8            | CRC8校验码    |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾          |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

要求ID为`14052A0C`，的LoRa主设备重新上报设置参数：
loRaDeviceTypeId

## 4、单片机收包应答(E002)

单片机收包应答： 软件版本号（可以断定续传），当前断点包数  （该指令每收到一个数据包，校验之后，写入相应Flash，然后应答）

#### 协议帧格式

|   字节索引   |     0     |  1\|2   |    3    |     4\|5     | 15-16  |    17-18     |  19   |       20-25       |
| :----------: | :-------: | :-----: | :-----: | :----------: | :----: | :----------: | :---: | :---------------: |
|    数据域    | FrameHead | FrameId | DataLen | DeviceTypeId | appVer | appPackCount | CRC8  |     FrameEnd      |
| 长度（byte） |     1     |    2    |    1    |      2       |   2    |      2       |   1   |         2         |
|   示例数据   |    FE     |  E002   |   0F    |     5555     |  0001  |    00 3C     |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域       | 说明                | 长度（byte） | 备注                                                                |
| ------------ | :------------------ | :----------: | :------------------------------------------------------------------ |
| FrameHead    | 帧头                |      2       | FE                                                                  |
| FrameId      | 帧ID                |      2       | E002                                                                |
| DataLen      | 数据长度            |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId | 设备类型ID          |      2       | 查看设备类型对照表                                                  |
| ZoneId       | 所属区域Id          |      1       | 0xFF表示所有区域                                                    |
| appVer       | app软件版本号       |      2       |                                                                     |
| appPackCount | 需要传输的app包编号 |      2       |                                                                     |
| CRC8         | CRC8校验码          |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd     | 帧尾                |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

要求ID为`14052A0C`，的LoRa主设备重新上报设置参数：

## 5、基地服务器按下位机要求发送APP数据包(A003)

单片机收包应答： 软件版本号（可以断定续传），当前断点包数  （该指令每收到一个数据包，校验之后，写入相应Flash，然后应答）

#### 协议帧格式

|   字节索引   |     0     |     1\|2      |    3    |     4\|5     |   6    | 19-20  |    21-22     | 22-149    |  23   |       24-29       |
| :----------: | :-------: | :-----------: | :-----: | :----------: | :----: | :----: | :----------: | --------- | :---: | :---------------: |
|    数据域    | FrameHead |    FrameId    | DataLen | DeviceTypeId | ZoneId | appVer | appPackCount | appPacket | CRC8  |     FrameEnd      |
| 长度（byte） |     1     |       2       |    1    |      2       |   1    |   2    |      2       | 128       |   1   |         2         |
|   示例数据   |    FE     | A003FrameHead |   XX    |     C001     |   01   |  0001  |    00 3C     |           |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域          | 说明                | 长度（byte） | 备注                                                                |
| --------------- | :------------------ | :----------: | :------------------------------------------------------------------ |
| DeviceFrameHead | 硬件帧头            |      1       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| Addr            | 设备地址            |      4       | 00000071(广播，所有设备上报自己的ID和SN)                            |
| deviceOthers    | 控制字等            |      3       | 仁钰LoRa M-KL9按地址发送时需要                                      |
| FrameHead       | 帧头                |      2       | FE                                                                  |
| FrameId         | 帧ID                |      2       | A003                                                                |
| DataLen         | 数据长度            |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId    | 设备类型ID          |      2       | 查看设备类型对照表                                                  |
| ZoneId          | 所属区域Id          |      1       | 0xFF表示所有区域                                                    |
| appVer          | app软件版本号       |      2       |                                                                     |
| appPackCount    | 需要传输的app包编号 |      2       |                                                                     |
| appPacket       | app包数据           |     128      | 每一包传128kb,最后一包小于128kb                                     |
| CRC8            | CRC8校验码          |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd        | 帧尾                |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**

要求ID为`14052A0C`，的LoRa主设备重新上报设置参数：

## 6、单片机接收并校验回复成功信息(E003)

单片机接收并校验回复成功信息，回执升级成功信息，跳到指定的软件版本向量

下位机空闲则进入bootloader,发送应答码

#### 返回协议帧格式

|   字节索引   |     0     |  1\|2   |    3    |     4\|5     |   15   |  16   |       17-22       |
| :----------: | :-------: | :-----: | :-----: | :----------: | :----: | :---: | :---------------: |
|    数据域    | FrameHead | FrameId | DataLen | DeviceTypeId | status | CRC8  |     FrameEnd      |
| 长度（byte） |     1     |    2    |    1    |      2       |   1    |   1   |         2         |
|   示例数据   |    FE     |  E003   |   0C    |     C001     |   55   |  00   | 0D 0A 0D 0A 0D 0A |

协议帧各字段域说明：

| 字段域       | 说明             | 长度（byte） | 备注                                                                |
| ------------ | :--------------- | :----------: | :------------------------------------------------------------------ |
| FrameHead    | 帧头             |      2       | FE                                                                  |
| FrameId      | 帧ID             |      2       | E003                                                                |
| DataLen      | 数据长度         |      1       | 从此位后开始计算（不包含自身），一直到`CRCR8`位结束（不包括CRC8位） |
| DeviceTypeId | 设备类型ID       |      2       | 查看设备类型对照表                                                  |
| ZoneId       | 所属区域Id       |      1       | 0xFF表示所有区域                                                    |
| status       | 设备当前工作状态 |      1       | 0x55：升级成功                                                      |
| CRC8         | CRC8校验码       |      1       | 用于进行CRC8计算的数据DataLen指代的长度                             |
| FrameEnd     | 帧尾             |      6       | 0d 0a 0d 0a 0d 0a                                                   |

**应用示例：**





# 七、帧ID对照表 

| 所属设备     | 帧ID | 功能                                | 备注       |
| ------------ | ---- | ----------------------------------- | ---------- |
| 所有设备     | A001 | 基地服务器发送升级指令              | bootloader |
| 所有设备     | E001 | 下位机空闲发送应答码                | bootloader |
| 所有设备     | A002 | 基地服务器发送前导码                | bootloader |
| 所有设备     | E002 | 单片机收包应答                      | bootloader |
| 所有设备     | A003 | 基地服务器按下位机要求发送APP数据包 | bootloader |
| 所有设备     | E003 | 单片机接收并校验回复成功信息        | bootloader |
|              |      |                                     |            |
| 所有LoRa设备 | A011 | 基地服务器查询LoRa设备当前工作参数  |            |
| 所有LoRa设备 | E011 | LoRa设备上报当前设置参数            |            |
| 所有LoRa设备 | A012 | 基地服务器设置LoRa设备工作组编号    |            |
| 所有LoRa设备 | E012 | LoRa设备请求设置工作组编号          |            |
| 所有LoRa设备 | A013 | 基地服务器设置设备SN及子设备总路数  |            |
| 所有LoRa设备 | E013 | LoRa设备请求设置SN及子设备总路数    |            |
| 所有LoRa设备 | A014 | 查询LoRa设备当前工作状态            |            |
| 所有LoRa设备 | E014 | LoRa设备上报当前工作状态            |            |
| 所有LoRa设备 | A015 | 强制停止设备指令                    |            |
| 所有LoRa设备 | E015 | LoRa设备通用回执                    |            |
|              |      |                                     |            |
|              |      |                                     |            |
| LoRa卷膜机   | A020 | 重置卷膜机行程                      |            |
| LoRa卷膜机   | E014 | 通用回执：09：成功，0A: 失败        |            |
| LoRa卷膜机   | A021 | 设置卷膜机开度                      |            |
| LoRa卷膜机   | E014 | 通用回执：0B：成功，0C: 失败        |            |
| LoRa卷膜机   | A022 | 设置工作阈值                        |            |
| LoRa卷膜机   | E014 | 通用回执：0D：成功，0E: 失败        |            |
|              |      |                                     |            |
| LoRa开关设备 | A025 | 设置LoRa开关设备开度及打开时间      |            |
|              |      |                                     |            |
# 八、 设备类型对照表

# 设备类型对照表

## 类型ID号段分配

- 未设置类型:0000

- 传感器类：0001~A000
- 执行器类：A001~BFFF
- 控制器：C001~DFFF
- 其他类型设备类型表：E001～FFFE



## 传感器类型（0001~A000）

| TypeId | 主控DeviceTypeId | 控制器/采集器名称       | 设备中文名             | 设备英文名                           | 类型                        |      | 备注 |
| ------ | ---------------- | ----------------------- | ---------------------- | ------------------------------------ | --------------------------- | ---- | ---- |
| 0001   | 0001             | 11因素TypeA采集器       | LoRa11因素传感器A型    | LoRa 11 Factor Sensor Type A         | LoRa_11Factor_Type_A        |      |      |
| 0002   | 0002             | 新增摄像头              | 云摄像头               | Cloud Camera                         | Cloud_Camera                |      |      |
| 0003   | 0003             | 9因素OutsideTypeA采集器 | LoRa9因素户外传感器A型 | LoRa outside 9Factor Type A          | LoRa_Outside_9Factor_Type_A |      |      |
| 0004   | C002             | 通用控制器              | 通用控制数字量输入设备 | LoRa common controller digital input | LoRa_Com_DI                 |      |      |
| 0005   | C002             | 通用控制器              | 通用控制模拟量输入设备 | LoRa common controller analog input  | LoRa_Com_AI                 |      |      |



## 执行器类型表（C001~DFFF）

| TypeId | DeviceTypeId | 控制器/采集器名称    | 设备中文名                                  | 设备英文名                                   | 类型         | 型号                   | 备注 |
| ------ | ------------ | -------------------- | ------------------------------------------- | -------------------------------------------- | ------------ | ---------------------- | ---- |
| C001   | C001         | LoRa单路卷膜机控制器 | LoRa无线单路DC 24V手自一体卷膜机控制器TypeA | LoRa Rolling Controller Master Type A        | LoRa_Roller  | MOTOR-DRV-LR-24DC/TYPA |      |
| C003   | C002         | 通用控制器           | 通用控制数字量输出设备                      | LoRa common controller type A digital output | LoRa_Com_DO  |                        |      |
| C004   | C002         | 通用控制器           | 通用控制模拟量输出设备                      | LoRa common controller type A analog output  | LoRa_Com_AO  |                        |      |
| C005   | C002         | 通用控制器           | 通用485设备                                 | LoRa common 485 device                       | LoRa_Com_485 |                        |      |
|        |              |                      |                                             |                                              |              |                        |      |



## 其他类型设备类型表（E001～FFFE）

| TypeId | 设备中文名            | 设备英文名               | 型号 | 备注         |
| ------ | --------------------- | ------------------------ | ---- | ------------ |
| E001   | ARM版基地服务器TypeA  | ARM Base Server Type A   |      | 香蕉派2      |
| E002   | x86基地服务器TypeA    | x86 Base Server Type A   |      | J1800主板    |
| F001   | GPRS-RS485适配器TypeA | GPRS-RS485 Adapter TypeA |      | STM32-SIM868 |